<!DOCTYPE html>
<html>
<head>
<title>Lawrence Editz</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#0f2027;color:white;text-align:center}
input,button{padding:10px;margin:5px;border-radius:6px;border:none}
button{background:#00c3ff;font-weight:bold;cursor:pointer}
.portfolio img{width:200px;margin:10px;border-radius:10px}
.admin{display:none;background:#1a1a1a;padding:20px;margin-top:20px}
</style>

</head>
<body>

<h1>Lawrence Editz</h1>

<h2>Book Service</h2>
<input type="text" id="name" placeholder="Your Name">
<input type="email" id="email" placeholder="Your Email">
<input type="text" id="service" placeholder="Service">
<button onclick="book()">Confirm Booking</button>

<h2>Portfolio</h2>
<div id="portfolio"></div>

<hr>

<h2>Admin Login</h2>
<input type="email" id="adminEmail" placeholder="Admin Email">
<input type="password" id="adminPass" placeholder="Password">
<button onclick="login()">Login</button>
<button onclick="logout()">Logout</button>

<div class="admin" id="adminPanel">
<h3>Admin Dashboard</h3>

<h4>Add Portfolio Image</h4>
<input type="text" id="imageUrl" placeholder="Image URL">
<button onclick="addImage()">Add Image</button>

<h4>Bookings List</h4>
<div id="bookingList"></div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } 
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// ðŸ”¥ REPLACE THIS WITH YOUR CONFIG
const firebaseConfig = {
  apiKey: "YOUR-KEY",
  authDomain: "YOUR-DOMAIN",
  projectId: "YOUR-ID",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

// BOOKING (Public can book)
window.book = async function(){
  await addDoc(collection(db,"bookings"),{
    name: name.value,
    email: email.value,
    service: service.value
  });
  alert("Booking Sent!");
}

// LOGIN
window.login = function(){
  signInWithEmailAndPassword(auth, adminEmail.value, adminPass.value)
  .then(()=>alert("Logged In"))
  .catch(()=>alert("Login Failed"));
}

// LOGOUT
window.logout = function(){
  signOut(auth);
}

// AUTH STATE
onAuthStateChanged(auth,(user)=>{
  if(user){
    document.getElementById("adminPanel").style.display="block";
    loadImages();
    loadBookings();
  }else{
    document.getElementById("adminPanel").style.display="none";
  }
});

// LOAD PORTFOLIO
async function loadImages(){
  const snap = await getDocs(collection(db,"portfolio"));
  portfolio.innerHTML="";
  snap.forEach(docSnap=>{
    const data=docSnap.data();
    portfolio.innerHTML+=`
      <div>
        <img src="${data.url}">
        <button onclick="deleteImage('${docSnap.id}')">Delete</button>
      </div>
    `;
  });
}

// ADD IMAGE
window.addImage = async function(){
  await addDoc(collection(db,"portfolio"),{url:imageUrl.value});
  loadImages();
}

// DELETE IMAGE
window.deleteImage = async function(id){
  await deleteDoc(doc(db,"portfolio",id));
  loadImages();
}

// LOAD BOOKINGS
async function loadBookings(){
  const snap = await getDocs(collection(db,"bookings"));
  bookingList.innerHTML="";
  snap.forEach(docSnap=>{
    const d=docSnap.data();
    bookingList.innerHTML+=`
      <p>${d.name} | ${d.email} | ${d.service}</p>
    `;
  });
}

</script>

</body>
</html>